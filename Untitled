<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Life Balance Pie Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; margin: 50px; }
    canvas { max-width: 500px; max-height: 500px; }
    h2 { margin-bottom: 30px; }
  </style>
</head>
<body>
  <h2>Life Balance Pie Chart</h2>
  <canvas id="lifeBalanceChart"></canvas>

  <script>
    const params = new URLSearchParams(window.location.search);

    const labels = [];
    const data = [];
    const colors = [
      '#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF','#FF9F40',
      '#C9CBCF','#8CBA80','#FF6666','#66CCFF','#FF99CC','#33CC99','#CCCC33'
    ];

    const fields = [
      'pct_family',
      'pct_friends',
      'pct_work',
      'pct_sleep',
      'pct_eating',
      'pct_health',
      'pct_self_improvement',
      'pct_hobbies',
      'pct_service',
      'pct_spirituality',
      'pct_self_care',
      'pct_other1',
      'pct_other2'
    ];

    fields.forEach((f, i) => {
      const val = parseFloat(params.get(f));
      if (!isNaN(val) && val > 0) {
        labels.push(f.replace('pct_','').replace('_',' '));
        data.push(val);
      }
    });

    const ctx = document.getElementById('lifeBalanceChart').getContext('2d');
    new Chart(ctx, {
      type: 'pie',
      data: {
        labels: labels,
        datasets: [{
          data: data,
          backgroundColor: colors.slice(0,data.length)
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });
  </script>
</body>
</html>
